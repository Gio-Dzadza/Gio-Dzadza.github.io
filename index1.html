<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Shopping list example</title>
    <style>
        li {
            margin-bottom: 10px;
        }

        li button {
            font-size: 8px;
            margin-left: 20px;
            color: #666;
        }
    </style>
</head>
<body>

<h1>My Tasks</h1>

<div>
    <form action="">
        <input type="text" name="item" id="item">
        <button type="submit">Add item</button>
    </form>
</div>

<ul>

</ul>
<div id="myData"></div>

<script>

    // fetch('https://us-central1-js04-b4877.cloudfunctions.net/tasks')
    //     .then(function (response){
    //         return response.json();
    //     })
    //     .then(function (data){
    //         appendData(data);
    //     })
    //     .catch(function (){
    //         console.log('error');
    //     });
    //
    // function appendData(data) {
    //     let mainContainer = document.getElementById("myData");
    //     for (let i = 0; i < data.length; i++) {
    //         let div = document.createElement("div");
    //         div.innerHTML = 'Name: ' + data[i] + ' ' + data[i];
    //         mainContainer.appendChild(div);
    //     }
    // }
    // }

    const ul = document.querySelector('ul');
    const input = document.querySelector('input');
    const button = document.querySelector('button');
    const form = document.querySelector('form');

    form.addEventListener('submit', (e) => {
        e.preventDefault();

        let myItem = input.value;

        fetch('https://us-central1-js04-b4877.cloudfunctions.net/tasks')
            .then(response => {
                console.log(response);
                return response.json();
                }
            )
            .then(data => {
                data.forEach(item =>{
                    let dataItem = document.createElement('span');
                    listItem.appendChild(dataItem);
                    dataItem.innerHTML = item;
                })
            })
            .catch(error => {
                console.log(error);
            });

        ul.style.listStyleType = 'none';

        const listItem = document.createElement('li');
        const checkInput = document.createElement('input');
        checkInput.type = 'checkbox';
        const listText = document.createElement('span');
        const deleteBtn = document.createElement('button');

        listItem.appendChild(checkInput);
        listItem.appendChild(listText);
        listText.textContent = myItem;
        listItem.appendChild(deleteBtn);
        deleteBtn.textContent = 'Delete';
        ul.appendChild(listItem);

        checkInput.addEventListener('change', (event) => {
            if (event.target.checked){
                listText.style.textDecoration = 'line-through';
            }else {
                listText.style.textDecoration = 'none';
            }
        });

        deleteBtn.addEventListener('click', () => {
            ul.removeChild(listItem);
        });

        input.value = '';
        input.focus();
    })
</script>
</body>
</html>